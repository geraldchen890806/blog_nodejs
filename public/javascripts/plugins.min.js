/*! renjm blog 07-01-2015 */
!function($){"use strict";window.GeUI=function(){};var Plugin=GeUI.Plugin=function(element){this.$element=$(element)};Plugin.prototype={constructor:Plugin,init:function(){var $deferred=$("[data-defer]",this.$element);$deferred.each(function(){var $this=$(this),name=$this.attr("data-defer");if(!$this[name])throw"A plugin with the name ["+name+"] could not be found. Make sure the script is included on the page.";$this[name]()})}},Plugin.define=function(name,fn){var old=$.fn[name];$.fn[name]=function(option){return this.each(function(){var $this=$(this),data=$this.data("off."+name),options=$.extend({},$.fn[name].defaults,$this.data(),"object"==typeof option&&option);data||$this.data("off."+name,data=new fn(this,options)),"string"==typeof option&&data[option]()})},$.fn[name].Constructor=fn,$.fn[name].noConflict=function(){return $.fn[name]=old,this}},Plugin.define("plugin",Plugin),window.clearMenus=function($el){$(".ge_menus").not($el).hide()},$(document).on("click.data-api",clearMenus),$(function(){$(document).plugin("init")})}(window.jQuery),!function($){"use strict";var Dropdown=function(element,options){this.$element=$(element),this.options=$.extend({},this.defaults,options),this.init()};Dropdown.prototype={constructor:Dropdown,defaults:{initSelect:""},init:function(){var $el=this.$element;this.$text=$el.find("a"),this.$menus=$el.find("ul"),this.$items=$el.find("ul input[type=checkbox]"),this.$initSelect=this.$menus.find("input[type=checkbox]"+this.options.initSelect),this.$selectAll=this.$menus.find("input[type=checkbox][value='All']"),this.$menus.on("click",function(e){e.stopPropagation()}),$el.on("click",$.proxy(this.toggle,this)),this.$items.on("click",$.proxy(this.check,this)),this.check()},toggle:function(e){e.stopPropagation();var isHide=!("none"!=this.$menus.css("display"));clearMenus(),isHide?(this.$text.focus(),this.$menus.toggle()):this.$text.blur()},check:function(e){e&&(this.$text.focus(),e.stopPropagation());var $checked=this.$menus.find("input:checked");$checked.length>1&&this.$selectAll.length&&($checked=$checked.not(this.$selectAll),this.$selectAll.prop("checked",!1)),e&&$(e.target).is(this.$selectAll)&&(this.$items.not(this.$selectAll).prop("checked",!1),$checked=this.$selectAll),this.$selectAll.length&&$checked.length==this.$items.not(this.$selectAll).length&&(this.$items.prop("checked",!1),this.$selectAll.prop("checked",!0),$checked=this.$selectAll);var res=[];$checked.each(function(){var $this=$(this).next();res.push($this.html())}),this.$text.html(res.join(","))}},GeUI.Plugin.define("dropdown",Dropdown)}(window.jQuery),!function($){"use strict";var Editor=function(element,options){this.$element=$(element),this.options=$.extend({},this.defaults,options),this.init()};Editor.prototype={constructor:Editor,defaults:{},init:function(){var $el=this.$element;this.$text=$el.find("textarea"),this.$preview=$el.find(".preview"),this.$btnEdit=$el.find(".commit-edit"),this.$btnPreview=$el.find(".commit-preview"),this.$btnEdit.on("click",$.proxy(this.showEdit,this)),this.$btnPreview.on("click",$.proxy(this.showPreview,this)),this.$preview.hide()},showEdit:function(e){e.preventDefault(),this.$preview.hide(),this.$btnPreview.removeClass("selected"),this.$text.show(),this.$btnEdit.addClass("selected")},showPreview:function(e){e.preventDefault();var self=this;this.$text.hide(),this.$btnEdit.removeClass("selected"),this.$preview.show(),this.$btnPreview.addClass("selected"),this.$preview.html("请稍后。。。。");var data=this.$text.val();$.ajax({type:"post",url:"/common/editor",data:{data:data},success:function(data){self.$preview.html(data)}})}},GeUI.Plugin.define("editor",Editor)}(window.jQuery);